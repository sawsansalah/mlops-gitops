# values.yaml
replicaCount: 1

backendStore:
  databaseMigration: true
  databaseConnectionCheck: true
  
  postgres:
    enabled: true
    # ✅ Use fully qualified DNS name: <service>.<namespace>.svc.cluster.local
    host: "postgres-postgresql.postgres.svc.cluster.local"
    port: 5432
    database: "mlflow"
    user: "mlflow"
    password: "mlflow123"
    driver: "psycopg2"

# ✅ Disable bundled PostgreSQL since you're using external one
postgresql:
  enabled: false

artifactRoot:
  proxiedArtifactStorage: true
  s3:
    enabled: true
    bucket: "mlflow-artifacts"
    awsAccessKeyId: "devops"
    awsSecretAccessKey: "admin@12345"

extraEnvVars:
  MLFLOW_S3_ENDPOINT_URL: http://s3-minio.local/
  AWS_DEFAULT_REGION: us-east-1
  MLFLOW_S3_IGNORE_TLS: "true"
  MLFLOW_SERVER_ALLOWED_HOSTS: "*"

ingress:
  enabled: true
  className: "nginx"
  hosts:
    - host: mlflow.local
      paths:
        - path: /
          pathType: Prefix

extraVolumes: 
  - name: mlflow-data
    emptyDir: {}

extraVolumeMounts:
  - name: mlflow-data
    mountPath: /mlflow